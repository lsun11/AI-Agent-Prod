/* ==========================================================================
   7. CLOCK GADGET
   ========================================================================== */

/* --- Collapsed State --- */
.gadget--clock.gadget--collapsed {
    width: 180px;
    height: 180px;
    border-radius: 50%;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.58) 0%, rgba(118, 75, 162, 0.57) 100%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 10px 24px rgba(118, 75, 162, 0.4);
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
}

.gadget--clock.gadget--collapsed .gadget-body { display: none !important; }
.gadget--clock.gadget--collapsed .sphere-texture { background: url("/static/assets/backgrounds/earth.gif"); }
.gadget--clock.gadget--collapsed::after { content: "" }

.gadget--clock.gadget--collapsed .gadget-header {
    display: block !important;
    position: absolute;
    inset: 0;
    background: transparent;
    border: none;
    z-index: 10;
    opacity: 0;
    cursor: grab;
}

.clock-collapsed-content {
    display: none;
    flex-direction: column;
    color: #fff;
    pointer-events: none;
}

.gadget--clock.gadget--collapsed .clock-collapsed-content { display: flex; }
.clock-big { font-size: 36px; font-weight: 700; line-height: 1; text-shadow: 0 2px 8px rgba(0,0,0,0.3); font-variant-numeric: tabular-nums; margin-bottom: 4px; }
.clock-loc { font-size: 11px; opacity: 0.9; max-width: 140px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin: 0 auto; }
.clock-date { font-size: 10px; opacity: 0.7; margin-top: 2px; text-transform: uppercase; letter-spacing: 0.5px; }

/* --- Expanded State --- */
.gadget--clock.gadget--expanded {
    width: 600px;
    height: 500px;
    min-width: min(300px, 32vw);
    min-height: min(220px, 26vh);
    background: #1a1b26;
    color: #fff;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.gadget--clock.gadget--expanded .gadget-body {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    min-height: 0;
    position: relative;
}

.gadget--clock.gadget--expanded .clock-collapsed-content { display: none; }
.gadget--clock.gadget--expanded .gadget-header { background: #1f202e; border-bottom: 1px solid #2f3042; color: #fff; }
.gadget--clock.gadget--expanded .gadget-toggle { background: rgba(255,255,255,0.1); color: #fff; border: none; }

/* Expanded Layout */
.clock-expanded-layout { height: auto; padding: 30px; display: flex; flex-direction: column; opacity: 0; }
.gadget--clock.gadget--expanded .clock-expanded-layout { animation: fileContentOpen 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; animation-delay: 0.1s; }
.gadget--clock.gadget--expanded.is-dragging .clock-expanded-layout { opacity: 1 !important; animation: none !important; }

.clock-hero { text-align: center; margin-bottom: 20px; }
.clock-hero-time { font-size: 56px; font-weight: 200; font-variant-numeric: tabular-nums; letter-spacing: -1px; }
.clock-hero-date { font-size: 18px; color: #a9b1d6; margin-bottom: 6px; }
.clock-hero-loc { font-size: 14px; color: #7aa2f7; font-weight: 600; }
.clock-divider { height: 1px; background: #2f3042; margin: 10px 0 20px 0; }
.clock-grid-label { font-size: 11px; color: #565f89; font-weight: 700; letter-spacing: 1px; margin-bottom: 15px; }
.clock-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 15px; }
.clock-city-card { background: #24283b; border-radius: 12px; padding: 15px; text-align: center; border: 1px solid #2f3042; transition: transform 0.2s, border-color 0.2s; }
.clock-city-card:hover { transform: translateY(-2px); border-color: #7aa2f7; }
.clock-city-name { font-size: 12px; color: #9aa5ce; margin-bottom: 6px; }
.clock-city-time { font-size: 20px; font-weight: 600; color: #fff; font-variant-numeric: tabular-nums; }
.clock-city-diff { font-size: 10px; color: #565f89; margin-top: 4px; }

/* Earth Map */
.earth-map-container {
    width: 100%;
    aspect-ratio: 2 / 1;
    background-color: #0b1026;
    background-image: url("/static/assets/backgrounds/earth.png");
    background-size: 100% 100%;
    background-position: center 28%;
    position: relative;
    margin-bottom: 20px;
    border: 1px solid #2f3042;
    box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
}
#clock-earth-canvas { width: 100%; height: 100%; display: block; }
.earth-marker { position: absolute; width: 8px; height: 8px; background: #00ffcc; border: 2px solid rgba(0,0,0,0.5); border-radius: 50%; transform: translate(-50%, -50%); box-shadow: 0 0 8px #00ffcc; top: 50%; left: 50%; transition: top 0.5s, left 0.5s; pointer-events: none; display: none; }

/* City Dots Layer */
.cities-layer { position: absolute; inset: 0; pointer-events: none; z-index: 5; }
.city-marker { position: absolute; width: 5px; height: 5px; background: rgba(255, 211, 59, 0.8); border-radius: 50%; transform: translate(-50%, -50%); box-shadow: 0 0 4px rgba(250, 237, 178, 0.51); pointer-events: auto; cursor: cell; }
.city-marker::before { content: ""; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 24px; height: 24px; background: transparent; border-radius: 50%; }
.city-marker:hover::after { content: attr(title); position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%); background: rgba(0, 0, 0, 0.9); padding: 4px 8px; border-radius: 4px; border: 1px solid rgba(255,255,255,0.2); font-size: 11px; font-weight: 600; white-space: nowrap; color: #fff; z-index: 100; pointer-events: none; }
.city-marker:hover { z-index: 20; }